if (V_d == 600){E_T <- 2.6}
if (V_d > 600 & V_d < 700){E_T <- 2.6 - 0.3 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 2.3}
if (V_d > 700 & V_d < 800){E_T <- 2.3 - 0.3 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 2.0}
if (V_d > 800 & V_d < 900){E_T <- 2.0 - 0.4 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 1.6}
if (V_d > 900 & V_d < 1000){E_T <- 1.6 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 1.3}
}
if (L == 1200){
if (V_d > 0 & V_d < 100){E_T <- 4.6 - 0.3 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 4.6}
if (V_d > 100 & V_d < 200){E_T <- 4.6 - 0.3 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 4.3}
if (V_d > 200 & V_d < 300){E_T <- 4.3 - 0.4 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 3.9}
if (V_d > 300 & V_d < 400){E_T <- 3.9 - 0.3 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 3.6}
if (V_d > 400 & V_d < 500){E_T <- 3.6 - 0.3 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 3.3}
if (V_d > 500 & V_d < 600){E_T <- 3.3 - 0.4 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 2.9}
if (V_d > 600 & V_d < 700){E_T <- 2.9 - 0.3 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 2.6}
if (V_d > 700 & V_d < 800){E_T <- 2.6 - 0.3 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 2.3}
if (V_d > 800 & V_d < 900){E_T <- 2.3 - 0.4 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 1.9}
if (V_d > 900 & V_d < 1000){E_T <- 1.9 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 1.6}
}
if (L == 1600){
if (V_d > 0 & V_d < 100){E_T <- 4.9 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 4.9}
if (V_d > 100 & V_d < 200){E_T <- 4.9 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 4.5}
if (V_d > 200 & V_d < 300){E_T <- 4.5 - 0.3 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 4.2}
if (V_d > 300 & V_d < 400){E_T <- 4.2 - 0.3 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 3.9}
if (V_d > 400 & V_d < 500){E_T <- 3.9 - 0.4 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 3.5}
if (V_d > 500 & V_d < 600){E_T <- 3.5 - 0.3 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 3.2}
if (V_d > 600 & V_d < 700){E_T <- 3.2 - 0.3 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 2.9}
if (V_d > 700 & V_d < 800){E_T <- 2.9 - 0.4 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 2.5}
if (V_d > 800 & V_d < 900){E_T <- 2.5 - 0.3 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 2.2}
if (V_d > 900 & V_d < 1000){E_T <- 2.2 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 1.9}
}
if (L == 2400){
if (V_d > 0 & V_d < 100){E_T <- 5.4 - 0.3 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 5.4}
if (V_d > 100 & V_d < 200){E_T <- 5.4 - 0.3 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 5.1}
if (V_d > 200 & V_d < 300){E_T <- 5.1 - 0.3 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 4.8}
if (V_d > 300 & V_d < 400){E_T <- 4.8 - 0.4 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 4.4}
if (V_d > 400 & V_d < 500){E_T <- 4.4 - 0.3 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 4.1}
if (V_d > 500 & V_d < 600){E_T <- 4.1 - 0.3 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 3.8}
if (V_d > 600 & V_d < 700){E_T <- 3.8 - 0.4 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 3.4}
if (V_d > 700 & V_d < 800){E_T <- 3.4 - 0.3 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 3.1}
if (V_d > 800 & V_d < 900){E_T <- 3.1 - 0.4 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 2.7}
if (V_d > 900 & V_d < 1000){E_T <- 2.7 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 2.4}
}
if (L == 3200){
if (V_d > 0 & V_d < 100){E_T <- 6.0 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 6.0}
if (V_d > 100 & V_d < 200){E_T <- 6.0 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 5.6}
if (V_d > 200 & V_d < 300){E_T <- 5.6 - 0.3 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 5.3}
if (V_d > 300 & V_d < 400){E_T <- 5.3 - 0.3 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 5.0}
if (V_d > 400 & V_d < 500){E_T <- 5.0 - 0.4 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 4.6}
if (V_d > 500 & V_d < 600){E_T <- 4.6 - 0.3 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 4.3}
if (V_d > 600 & V_d < 700){E_T <- 4.3 - 0.3 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 4.0}
if (V_d > 700 & V_d < 800){E_T <- 4.0 - 0.4 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 3.6}
if (V_d > 800 & V_d < 900){E_T <- 3.6 - 0.3 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 3.3}
if (V_d > 900 & V_d < 1000){E_T <- 3.3 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 3.0}
}
if (L == 4800){
if (V_d > 0 & V_d < 100){E_T <- 7.1 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 7.1}
if (V_d > 100 & V_d < 200){E_T <- 7.1 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 6.7}
if (V_d > 200 & V_d < 300){E_T <- 6.7 - 0.3 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 6.4}
if (V_d > 300 & V_d < 400){E_T <- 6.4 - 0.3 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 6.1}
if (V_d > 400 & V_d < 500){E_T <- 6.1 - 0.4 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 5.7}
if (V_d > 500 & V_d < 600){E_T <- 5.7 - 0.3 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 5.4}
if (V_d > 600 & V_d < 700){E_T <- 5.4 - 0.3 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 5.1}
if (V_d > 700 & V_d < 800){E_T <- 5.1 - 0.4 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 4.7}
if (V_d > 800 & V_d < 900){E_T <- 4.7 - 0.3 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 4.4}
if (V_d > 900 & V_d < 1000){E_T <- 4.4 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 4.1}
}
if (L == 6400){
if (V_d > 0 & V_d < 100){E_T <- 8.2 - 0.3 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 8.2}
if (V_d > 100 & V_d < 200){E_T <- 8.2 - 0.3 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 7.9}
if (V_d > 200 & V_d < 300){E_T <- 7.9 - 0.4 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 7.5}
if (V_d > 300 & V_d < 400){E_T <- 7.5 - 0.3 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 7.2}
if (V_d > 400 & V_d < 500){E_T <- 7.2 - 0.4 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 6.8}
if (V_d > 500 & V_d < 600){E_T <- 6.8 - 0.3 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 6.5}
if (V_d > 600 & V_d < 700){E_T <- 6.5 - 0.3 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 6.2}
if (V_d > 700 & V_d < 800){E_T <- 6.2 - 0.4 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 5.8}
if (V_d > 800 & V_d < 900){E_T <- 5.8 - 0.3 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 5.5}
if (V_d > 900 & V_d < 1000){E_T <- 5.5 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 5.2}
}
}
if (gradient == 0.07){
if (L == 400){
if (V_d > 0 & V_d < 100){E_T <- 4.9 - 0.3 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 4.9}
if (V_d > 100 & V_d < 200){E_T <- 4.9 - 0.3 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 4.6}
if (V_d > 200 & V_d < 300){E_T <- 4.6 - 0.3 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 4.3}
if (V_d > 300 & V_d < 400){E_T <- 4.3 - 0.4 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 3.9}
if (V_d > 400 & V_d < 500){E_T <- 3.9 - 0.3 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 3.6}
if (V_d > 500 & V_d < 600){E_T <- 3.6 - 0.3 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 3.3}
if (V_d > 600 & V_d < 700){E_T <- 3.3 - 0.4 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 2.9}
if (V_d > 700 & V_d < 800){E_T <- 2.9 - 0.3 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 2.6}
if (V_d > 800 & V_d < 900){E_T <- 2.6 - 0.4 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 2.2}
if (V_d > 900 & V_d < 1000){E_T <- 2.2 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 1.9}
}
if (L == 800){
if (V_d > 0 & V_d < 100){E_T <- 5.2 - 0.3 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 5.2}
if (V_d > 100 & V_d < 200){E_T <- 5.2 - 0.3 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 4.9}
if (V_d > 200 & V_d < 300){E_T <- 4.9 - 0.4 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 4.5}
if (V_d > 300 & V_d < 400){E_T <- 4.5 - 0.3 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 4.2}
if (V_d > 400 & V_d < 500){E_T <- 4.2 - 0.3 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 3.9}
if (V_d > 500 & V_d < 600){E_T <- 3.9 - 0.4 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 3.5}
if (V_d > 600 & V_d < 700){E_T <- 3.5 - 0.3 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 3.2}
if (V_d > 700 & V_d < 800){E_T <- 3.2 - 0.3 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 2.9}
if (V_d > 800 & V_d < 900){E_T <- 2.9 - 0.4 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 2.5}
if (V_d > 900 & V_d < 1000){E_T <- 2.5 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 2.2}
}
if (L == 1200){
if (V_d > 0 & V_d < 100){E_T <- 5.5 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 5.5}
if (V_d > 100 & V_d < 200){E_T <- 5.5 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 5.1}
if (V_d > 200 & V_d < 300){E_T <- 5.1 - 0.3 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 4.8}
if (V_d > 300 & V_d < 400){E_T <- 4.8 - 0.3 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 4.5}
if (V_d > 400 & V_d < 500){E_T <- 4.5 - 0.4 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 4.1}
if (V_d > 500 & V_d < 600){E_T <- 4.1 - 0.3 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 3.8}
if (V_d > 600 & V_d < 700){E_T <- 3.8 - 0.3 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 3.5}
if (V_d > 700 & V_d < 800){E_T <- 3.5 - 0.4 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 3.1}
if (V_d > 800 & V_d < 900){E_T <- 3.1 - 0.3 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 2.8}
if (V_d > 900 & V_d < 1000){E_T <- 2.8 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 2.5}
}
if (L == 1600){
if (V_d > 0 & V_d < 100){E_T <- 5.8 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 5.8}
if (V_d > 100 & V_d < 200){E_T <- 5.8 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 5.4}
if (V_d > 200 & V_d < 300){E_T <- 5.4 - 0.3 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 5.1}
if (V_d > 300 & V_d < 400){E_T <- 5.1 - 0.4 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 4.7}
if (V_d > 400 & V_d < 500){E_T <- 4.7 - 0.3 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 4.4}
if (V_d > 500 & V_d < 600){E_T <- 4.4 - 0.3 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 4.1}
if (V_d > 600 & V_d < 700){E_T <- 4.1 - 0.4 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 3.7}
if (V_d > 700 & V_d < 800){E_T <- 3.7 - 0.3 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 3.4}
if (V_d > 800 & V_d < 900){E_T <- 3.4 - 0.3 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 3.1}
if (V_d > 900 & V_d < 1000){E_T <- 3.1 - 0.4 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 2.7}
}
if (L == 2400){
if (V_d > 0 & V_d < 100){E_T <- 6.3 - 0.3 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 6.3}
if (V_d > 100 & V_d < 200){E_T <- 6.3 - 0.3 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 6.0}
if (V_d > 200 & V_d < 300){E_T <- 6.0 - 0.4 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 5.6}
if (V_d > 300 & V_d < 400){E_T <- 5.6 - 0.3 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 5.3}
if (V_d > 400 & V_d < 500){E_T <- 5.3 - 0.3 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 5.0}
if (V_d > 500 & V_d < 600){E_T <- 5.0 - 0.4 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 4.6}
if (V_d > 600 & V_d < 700){E_T <- 4.6 - 0.3 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 4.3}
if (V_d > 700 & V_d < 800){E_T <- 4.3 - 0.3 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 4.0}
if (V_d > 800 & V_d < 900){E_T <- 4.0 - 0.4 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 3.6}
if (V_d > 900 & V_d < 1000){E_T <- 3.6 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 3.3}
}
if (L == 3200){
if (V_d > 0 & V_d < 100){E_T <- 6.9 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 6.9}
if (V_d > 100 & V_d < 200){E_T <- 6.9 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 6.5}
if (V_d > 200 & V_d < 300){E_T <- 6.5 - 0.3 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 6.2}
if (V_d > 300 & V_d < 400){E_T <- 6.2 - 0.3 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 5.9}
if (V_d > 400 & V_d < 500){E_T <- 5.9 - 0.4 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 5.5}
if (V_d > 500 & V_d < 600){E_T <- 5.5 - 0.3 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 5.2}
if (V_d > 600 & V_d < 700){E_T <- 5.2 - 0.3 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 4.9}
if (V_d > 700 & V_d < 800){E_T <- 4.9 - 0.4 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 4.5}
if (V_d > 800 & V_d < 900){E_T <- 4.5 - 0.3 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 4.2}
if (V_d > 900 & V_d < 1000){E_T <- 4.2 - 0.4 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 3.8}
}
if (L == 4800){
if (V_d > 0 & V_d < 100){E_T <- 8.0 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 8.0}
if (V_d > 100 & V_d < 200){E_T <- 8.0 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 7.6}
if (V_d > 200 & V_d < 300){E_T <- 7.6 - 0.3 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 7.3}
if (V_d > 300 & V_d < 400){E_T <- 7.3 - 0.3 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 7.0}
if (V_d > 400 & V_d < 500){E_T <- 7.0 - 0.4 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 6.6}
if (V_d > 500 & V_d < 600){E_T <- 6.6 - 0.3 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 6.3}
if (V_d > 600 & V_d < 700){E_T <- 6.3 - 0.3 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 6.0}
if (V_d > 700 & V_d < 800){E_T <- 6.0 - 0.4 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 5.6}
if (V_d > 800 & V_d < 900){E_T <- 5.6 - 0.3 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 5.3}
if (V_d > 900 & V_d < 1000){E_T <- 5.3 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 5.0}
}
if (L == 6400){
if (V_d > 0 & V_d < 100){E_T <- 9.1 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 100){E_T <- 9.1}
if (V_d > 100 & V_d < 200){E_T <- 9.1 - 0.4 * (V_d - 100) * 0.01}
if (V_d == 200){E_T <- 8.7}
if (V_d > 200 & V_d < 300){E_T <- 8.7 - 0.3 * (V_d - 200) * 0.01}
if (V_d == 300){E_T <- 8.4}
if (V_d > 300 & V_d < 400){E_T <- 8.4 - 0.3 * (V_d - 300) * 0.01}
if (V_d == 400){E_T <- 8.1}
if (V_d > 400 & V_d < 500){E_T <- 8.1 - 0.4 * (V_d - 400) * 0.01}
if (V_d == 500){E_T <- 7.7}
if (V_d > 500 & V_d < 600){E_T <- 7.7 - 0.3 * (V_d - 500) * 0.01}
if (V_d == 600){E_T <- 7.4}
if (V_d > 600 & V_d < 700){E_T <- 7.4 - 0.3 * (V_d - 600) * 0.01}
if (V_d == 700){E_T <- 7.1}
if (V_d > 700 & V_d < 800){E_T <- 7.1 - 0.4 * (V_d - 700) * 0.01}
if (V_d == 800){E_T <- 6.7}
if (V_d > 800 & V_d < 900){E_T <- 6.7 - 0.3 * (V_d - 800) * 0.01}
if (V_d == 900){E_T <- 6.4}
if (V_d > 900 & V_d < 1000){E_T <- 6.4 - 0.3 * (V_d - 900) * 0.01}
if (V_d >= 1000){E_T <- 6.1}
}
}
}
}
E_T
}
E_T_2lane_Road(topography = 'specific_slope', gradient = 0.04, L = 1200, V_d = 838, output = 'travel_speed')
# man 폴더에 document 일괄생성
document()
# 작업 디렉토리 변경: 프로젝트
setwd('D:/projects/KHCMinR')
# man 폴더에 document 일괄생성
document()
#load
devtools::load_all()
# 패키지 설치 : setwd()로 작업디렉토리 변경 후
setwd("..")
install('KHCMinR') #install.packages()가 아닙니다!
# 패키지 설치 : setwd()로 작업디렉토리 변경 후
setwd("..")
install('KHCMinR') #install.packages()가 아닙니다!
# 패키지 설치 : setwd()로 작업디렉토리 변경 후
setwd("..")
install('KHCMinR') #install.packages()가 아닙니다!
# 작업 디렉토리 변경: 프로젝트
setwd('D:/projects/KHCMinR')
# man 폴더에 document 일괄생성
document()
# 패키지 설치 : setwd()로 작업디렉토리 변경 후
setwd("..")
install('KHCMinR') #install.packages()가 아닙니다!
#' Pedestrian traffic flow rate (person/min/m)
#'
#' It follows <Formula 14-1> in KHCM(2013), p.613
#' @param S Walking speed (m/min)
#' @param D Walking density (person/㎡)
#' @param M Pedestrian occupied space (㎡/person)
#' @export V_passenger
#' @examples
V_passenger <- function(S = NULL, D = NULL, M = NULL){
if (is.null(D) == FALSE){
v <- S * D
}
else{
v <- S / M
}
v
}
V_passenger(S = 50, D = 3)
V_passenger(S = 32.3, M = 12)
#' Level of Service(LOS) for Pedestrian
#'
#' It follows <Table 14-1> in KHCM(2013), p.616
#' @param V Pedestrian traffic flow rate (person/min/m). See V_pedestrian()
#' @param S Walking speed (m/min)
#' @param D Walking density (person/㎡)
#' @param M Pedestrian occupied space (㎡/person)
#' @export LOS_pedestrian
#' @examples
LOS_pedestrian <- function(V = NULL, S = NULL, D = NULL, M = NULL){
if (is.null(V) == FALSE){
if (V >= 0 & V <= 20){los <- 'A'}
if (V > 20 & V <= 32){los <- 'B'}
if (V > 32 & V <= 46){los <- 'C'}
if (V > 46 & V <= 70){los <- 'D'}
if (V > 70 & V <= 106){los <- 'E'}
if (V > 106){los <- 'F'}
}
else{
if (is.null(D) == FALSE){
V <- V_pedestrian(S = S, D = D)
if (V >= 0 & V <= 20){los <- 'A'}
if (V > 20 & V <= 32){los <- 'B'}
if (V > 32 & V <= 46){los <- 'C'}
if (V > 46 & V <= 70){los <- 'D'}
if (V > 70 & V <= 106){los <- 'E'}
if (V > 106){los <- 'F'}
}
else{
if (is.null(M) == FALSE){
V <- V_pedestrian(S = S, M = M)
if (V >= 0 & V <= 20){los <- 'A'}
if (V > 20 & V <= 32){los <- 'B'}
if (V > 32 & V <= 46){los <- 'C'}
if (V > 46 & V <= 70){los <- 'D'}
if (V > 70 & V <= 106){los <- 'E'}
if (V > 106){los <- 'F'}
}
else{'At least one of D or M is needed.'}
}
}
los
}
LOS_pedestrian(V = 32.1)
LOS_pedestrian(S = 15.32, D = 2.3)
#' Pedestrian traffic flow rate (person/min/m)
#'
#' It follows <Formula 14-1>, <Formula 14-2> in KHCM(2013), p.613
#' @param S Walking speed (m/min)
#' @param D Walking density (person/㎡)
#' @param M Pedestrian occupied space (㎡/person)
#' @export V_pedestrian
#' @examples
#' V_pedestrian(S = 50, D = 3)
#' V_pedestrian(S = 32.3, M = 12)
V_pedestrian <- function(S = NULL, D = NULL, M = NULL){
if (is.null(D) == FALSE){
v <- S * D
}
else{
v <- S / M
}
v
}
LOS_pedestrian(S = 15.32, D = 2.3)
LOS_pedestrian(S = 43.21, M = 19.22)
#' Level of Service(LOS) for Pedestrian in Stairs
#'
#' It follows <Table 14-1> in KHCM(2013), p.616
#' @param group Choose one from: \code{'yes'}, \code{'no'}
#' @param V Pedestrian traffic flow rate (person/min/m). See V_pedestrian()
#' @param S Walking speed (m/min)
#' @param D Walking density (person/㎡)
#' @param M Pedestrian occupied space (㎡/person)
#' @export LOS_pedestrian_stair
#' @examples
LOS_pedestrian_stair <- function(V = NULL, S = NULL, D = NULL, M = NULL){
if (is.null(V) == FALSE){v <- V}
else{
if (is.null(D) == FALSE){v <- V_pedestrian(S = S, D = D)}
else{
if (is.null(M) == FALSE){v <- V_pedestrian(S = S, M = M)}
else{'At least one of D or M is needed.'}
}
}
if (group == 'no'){
if (v >= 0 & v <= 18){los <- 'A'}
if (v > 18 & v <= 20){los <- 'B'}
if (v > 20 & v <= 25){los <- 'C'}
if (v > 25 & v <= 32){los <- 'D'}
if (v > 32 & v <= 52){los <- 'E'}
if (v > 52){los <- 'F'}
}
if (group == 'yes'){
if (v >= 0 & v <= 43){los <- 'A'}
if (v > 43 & v <= 50){los <- 'B'}
if (v > 50 & v <= 65){los <- 'C'}
if (v > 95 & v <= 69){los <- 'D'}
if (v > 69 & v <= 74){los <- 'E'}
if (v > 74){los <- 'F'}
}
los
}
#' Level of Service(LOS) for Pedestrian in Stairs
#'
#' It follows <Table 14-1> in KHCM(2013), p.616
#' @param group Choose one from: \code{'yes'}, \code{'no'}
#' @param V Pedestrian traffic flow rate (person/min/m). See V_pedestrian()
#' @param S Walking speed (m/min)
#' @param D Walking density (person/㎡)
#' @param M Pedestrian occupied space (㎡/person)
#' @export LOS_pedestrian_stair
#' @examples
LOS_pedestrian_stair <- function(group = NULL, V = NULL, S = NULL, D = NULL, M = NULL){
if (is.null(V) == FALSE){v <- V}
else{
if (is.null(D) == FALSE){v <- V_pedestrian(S = S, D = D)}
else{
if (is.null(M) == FALSE){v <- V_pedestrian(S = S, M = M)}
else{'At least one of D or M is needed.'}
}
}
if (group == 'no'){
if (v >= 0 & v <= 18){los <- 'A'}
if (v > 18 & v <= 20){los <- 'B'}
if (v > 20 & v <= 25){los <- 'C'}
if (v > 25 & v <= 32){los <- 'D'}
if (v > 32 & v <= 52){los <- 'E'}
if (v > 52){los <- 'F'}
}
if (group == 'yes'){
if (v >= 0 & v <= 43){los <- 'A'}
if (v > 43 & v <= 50){los <- 'B'}
if (v > 50 & v <= 65){los <- 'C'}
if (v > 95 & v <= 69){los <- 'D'}
if (v > 69 & v <= 74){los <- 'E'}
if (v > 74){los <- 'F'}
}
los
}
LOS_pedestrian_stair(group = 'yes', V = 31)
LOS_pedestrian_stair(group = 'no', S = 13.2, D = 33.92)
LOS_pedestrian_stair(group = 'yes', S = 75.233, M = 21.74)
