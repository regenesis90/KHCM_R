if (lane == 2){
t_c <- 3.21
t_f <- 3.15
t_min <- 0
n_e <- 1.7
}
c <- 3600 * (1-(V_c * t_min / 3600)) * (n_e/t_f) * exp(-1 * (V_c/3600) * (t_c = 0.5 * t_f - t_min)) * f_p
c
}
#' Roundabout ramp capacity(c_roundabout, pcph)
#'
#' It follows <Formula 11-2> in KHCM(2013) p.496
#' @param lane roundabout type. Choose one from : \code{1}, \code{2}
#' @param V_c Conflict traffic volume(pcph)
#' @param f_p Crossing Pedestrian Influence Coefficient. See f_p()
#' @export c_roundabout
#' @examples
c_roundabout <- function(lane = NULL, V_c = NULL, f_p = NULL){
if (lane == 1){
t_c <- 3.21
t_f <- 3.15
t_min <- 2.05
n_e <- 1
}
if (lane == 2){
t_c <- 3.21
t_f <- 3.15
t_min <- 0
n_e <- 1.7
}
c <- 3600 * (1-(V_c * t_min / 3600)) * (n_e/t_f) * exp(-1 * (V_c/3600) * (t_c = 0.5 * t_f - t_min)) * f_p
c
}
c_roundabout(lane = 1, V_c = 382, f_p = 0.8)
#' Influence coefficient on the number of pedestrians by conflicting traffic volume(f_p)
#'
#' It follows <Table 11-3> in KHCM(2013) p.498
#' @param lane roundabout type. Choose one from : \code{1}, \code{2}
#' @param V_ci Conflict Traffic Volume(pcph)
#' @param p_v Amount of passenger (person/hour)
#' @export f_p
#' @examples
f_p <- function(lane = NULL, V_ci = NULL, p_v = NULL){
if (lane == 1){
if (p_v >= 0 & p_v <= 50){
if (V_ci >= 0 & V_ci <= 100){f <- 1.0}
if (V_ci >= 101 & V_ci <= 200){f <- 1.0}
if (V_ci >= 201 & V_ci <= 300){f <- 1.0}
if (V_ci >= 301 & V_ci <= 400){f <- 1.0}
if (V_ci >= 401 & V_ci <= 500){f <- 1.0}
if (V_ci >= 501 & V_ci <= 600){f <- 1.0}
if (V_ci >= 601 & V_ci <= 700){f <- 1.0}
if (V_ci >= 701 & V_ci <= 800){f <- 1.0}
if (V_ci >= 801 & V_ci <= 900){f <- 1.0}
if (V_ci >= 901 & V_ci <= 1000){f <- 1.0}
if (V_ci >= 1001 & V_ci <= 1100){f <- 1.0}
if (V_ci >= 1101 & V_ci <= 1200){f <- 1.0}
if (V_ci >= 1201 & V_ci <= 1300){f <- 1.0}
if (V_ci >= 1301 & V_ci <= 1400){f <- 1.0}
if (V_ci >= 1401){f <- 1.0}
}
if (p_v >= 51 & p_v <= 150){
if (V_ci >= 0 & V_ci <= 100){f <- 0.9}
if (V_ci >= 101 & V_ci <= 200){f <- 0.9}
if (V_ci >= 201 & V_ci <= 300){f <- 0.9}
if (V_ci >= 301 & V_ci <= 400){f <- 0.9}
if (V_ci >= 401 & V_ci <= 500){f <- 0.9}
if (V_ci >= 501 & V_ci <= 600){f <- 0.9}
if (V_ci >= 601 & V_ci <= 700){f <- 0.9}
if (V_ci >= 701 & V_ci <= 800){f <- 1.0}
if (V_ci >= 801 & V_ci <= 900){f <- 1.0}
if (V_ci >= 901 & V_ci <= 1000){f <- 1.0}
if (V_ci >= 1001 & V_ci <= 1100){f <- 1.0}
if (V_ci >= 1101 & V_ci <= 1200){f <- 1.0}
if (V_ci >= 1201 & V_ci <= 1300){f <- 1.0}
if (V_ci >= 1301 & V_ci <= 1400){f <- 1.0}
if (V_ci >= 1401){f <- 1.0}
}
if (p_v >= 151 & p_v <= 250){
if (V_ci >= 0 & V_ci <= 100){f <- 0.8}
if (V_ci >= 101 & V_ci <= 200){f <- 0.8}
if (V_ci >= 201 & V_ci <= 300){f <- 0.8}
if (V_ci >= 301 & V_ci <= 400){f <- 0.8}
if (V_ci >= 401 & V_ci <= 500){f <- 0.8}
if (V_ci >= 501 & V_ci <= 600){f <- 0.9}
if (V_ci >= 601 & V_ci <= 700){f <- 0.9}
if (V_ci >= 701 & V_ci <= 800){f <- 0.9}
if (V_ci >= 801 & V_ci <= 900){f <- 1.0}
if (V_ci >= 901 & V_ci <= 1000){f <- 1.0}
if (V_ci >= 1001 & V_ci <= 1100){f <- 1.0}
if (V_ci >= 1101 & V_ci <= 1200){f <- 1.0}
if (V_ci >= 1201 & V_ci <= 1300){f <- 1.0}
if (V_ci >= 1301 & V_ci <= 1400){f <- 1.0}
if (V_ci >= 1401){f <- 1.0}
}
if (p_v >= 251 & p_v <= 350){
if (V_ci >= 0 & V_ci <= 100){f <- 0.7}
if (V_ci >= 101 & V_ci <= 200){f <- 0.7}
if (V_ci >= 201 & V_ci <= 300){f <- 0.7}
if (V_ci >= 301 & V_ci <= 400){f <- 0.7}
if (V_ci >= 401 & V_ci <= 500){f <- 0.8}
if (V_ci >= 501 & V_ci <= 600){f <- 0.8}
if (V_ci >= 601 & V_ci <= 700){f <- 0.8}
if (V_ci >= 701 & V_ci <= 800){f <- 0.9}
if (V_ci >= 801 & V_ci <= 900){f <- 1.0}
if (V_ci >= 901 & V_ci <= 1000){f <- 1.0}
if (V_ci >= 1001 & V_ci <= 1100){f <- 1.0}
if (V_ci >= 1101 & V_ci <= 1200){f <- 1.0}
if (V_ci >= 1201 & V_ci <= 1300){f <- 1.0}
if (V_ci >= 1301 & V_ci <= 1400){f <- 1.0}
if (V_ci >= 1401){f <- 1.0}
}
if (p_v >= 351){
if (V_ci >= 0 & V_ci <= 100){f <- 0.6}
if (V_ci >= 101 & V_ci <= 200){f <- 0.6}
if (V_ci >= 201 & V_ci <= 300){f <- 0.7}
if (V_ci >= 301 & V_ci <= 400){f <- 0.7}
if (V_ci >= 401 & V_ci <= 500){f <- 0.7}
if (V_ci >= 501 & V_ci <= 600){f <- 0.8}
if (V_ci >= 601 & V_ci <= 700){f <- 0.8}
if (V_ci >= 701 & V_ci <= 800){f <- 0.9}
if (V_ci >= 801 & V_ci <= 900){f <- 0.9}
if (V_ci >= 901 & V_ci <= 1000){f <- 1.0}
if (V_ci >= 1001 & V_ci <= 1100){f <- 1.0}
if (V_ci >= 1101 & V_ci <= 1200){f <- 1.0}
if (V_ci >= 1201 & V_ci <= 1300){f <- 1.0}
if (V_ci >= 1301 & V_ci <= 1400){f <- 1.0}
if (V_ci >= 1401){f <- 1.0}
}
}
if (lane == 2){
if (p_v >= 0 & p_v <= 50){
if (V_ci >= 0 & V_ci <= 100){f <- 1.0}
if (V_ci >= 101 & V_ci <= 200){f <- 1.0}
if (V_ci >= 201 & V_ci <= 300){f <- 1.0}
if (V_ci >= 301 & V_ci <= 400){f <- 1.0}
if (V_ci >= 401 & V_ci <= 500){f <- 1.0}
if (V_ci >= 501 & V_ci <= 600){f <- 1.0}
if (V_ci >= 601 & V_ci <= 700){f <- 1.0}
if (V_ci >= 701 & V_ci <= 800){f <- 1.0}
if (V_ci >= 801 & V_ci <= 900){f <- 1.0}
if (V_ci >= 901 & V_ci <= 1000){f <- 1.0}
if (V_ci >= 1001 & V_ci <= 1100){f <- 1.0}
if (V_ci >= 1101 & V_ci <= 1200){f <- 1.0}
if (V_ci >= 1201 & V_ci <= 1300){f <- 1.0}
if (V_ci >= 1301 & V_ci <= 1400){f <- 1.0}
if (V_ci >= 1401){f <- 1.0}
}
if (p_v >= 51 & p_v <= 150){
if (V_ci >= 0 & V_ci <= 100){f <- 0.9}
if (V_ci >= 101 & V_ci <= 200){f <- 0.9}
if (V_ci >= 201 & V_ci <= 300){f <- 0.9}
if (V_ci >= 301 & V_ci <= 400){f <- 0.9}
if (V_ci >= 401 & V_ci <= 500){f <- 0.9}
if (V_ci >= 501 & V_ci <= 600){f <- 0.9}
if (V_ci >= 601 & V_ci <= 700){f <- 0.9}
if (V_ci >= 701 & V_ci <= 800){f <- 0.9}
if (V_ci >= 801 & V_ci <= 900){f <- 0.9}
if (V_ci >= 901 & V_ci <= 1000){f <- 1.0}
if (V_ci >= 1001 & V_ci <= 1100){f <- 1.0}
if (V_ci >= 1101 & V_ci <= 1200){f <- 1.0}
if (V_ci >= 1201 & V_ci <= 1300){f <- 1.0}
if (V_ci >= 1301 & V_ci <= 1400){f <- 1.0}
if (V_ci >= 1401){f <- 1.0}
}
if (p_v >= 151 & p_v <= 250){
if (V_ci >= 0 & V_ci <= 100){f <- 0.8}
if (V_ci >= 101 & V_ci <= 200){f <- 0.8}
if (V_ci >= 201 & V_ci <= 300){f <- 0.8}
if (V_ci >= 301 & V_ci <= 400){f <- 0.8}
if (V_ci >= 401 & V_ci <= 500){f <- 0.8}
if (V_ci >= 501 & V_ci <= 600){f <- 0.8}
if (V_ci >= 601 & V_ci <= 700){f <- 0.8}
if (V_ci >= 701 & V_ci <= 800){f <- 0.8}
if (V_ci >= 801 & V_ci <= 900){f <- 0.8}
if (V_ci >= 901 & V_ci <= 1000){f <- 0.8}
if (V_ci >= 1001 & V_ci <= 1100){f <- 0.9}
if (V_ci >= 1101 & V_ci <= 1200){f <- 1.0}
if (V_ci >= 1201 & V_ci <= 1300){f <- 1.0}
if (V_ci >= 1301 & V_ci <= 1400){f <- 1.0}
if (V_ci >= 1401){f <- 1.0}
}
if (p_v >= 251 & p_v <= 350){
if (V_ci >= 0 & V_ci <= 100){f <- 0.7}
if (V_ci >= 101 & V_ci <= 200){f <- 0.7}
if (V_ci >= 201 & V_ci <= 300){f <- 0.7}
if (V_ci >= 301 & V_ci <= 400){f <- 0.7}
if (V_ci >= 401 & V_ci <= 500){f <- 0.7}
if (V_ci >= 501 & V_ci <= 600){f <- 0.7}
if (V_ci >= 601 & V_ci <= 700){f <- 0.7}
if (V_ci >= 701 & V_ci <= 800){f <- 0.8}
if (V_ci >= 801 & V_ci <= 900){f <- 0.8}
if (V_ci >= 901 & V_ci <= 1000){f <- 0.8}
if (V_ci >= 1001 & V_ci <= 1100){f <- 0.9}
if (V_ci >= 1101 & V_ci <= 1200){f <- 0.9}
if (V_ci >= 1201 & V_ci <= 1300){f <- 0.9}
if (V_ci >= 1301 & V_ci <= 1400){f <- 1.0}
if (V_ci >= 1401){f <- 1.0}
}
if (p_v >= 351){
if (V_ci >= 0 & V_ci <= 100){f <- 0.6}
if (V_ci >= 101 & V_ci <= 200){f <- 0.6}
if (V_ci >= 201 & V_ci <= 300){f <- 0.6}
if (V_ci >= 301 & V_ci <= 400){f <- 0.6}
if (V_ci >= 401 & V_ci <= 500){f <- 0.6}
if (V_ci >= 501 & V_ci <= 600){f <- 0.6}
if (V_ci >= 601 & V_ci <= 700){f <- 0.6}
if (V_ci >= 701 & V_ci <= 800){f <- 0.7}
if (V_ci >= 801 & V_ci <= 900){f <- 0.7}
if (V_ci >= 901 & V_ci <= 1000){f <- 0.7}
if (V_ci >= 1001 & V_ci <= 1100){f <- 0.8}
if (V_ci >= 1101 & V_ci <= 1200){f <- 0.8}
if (V_ci >= 1201 & V_ci <= 1300){f <- 0.8}
if (V_ci >= 1301 & V_ci <= 1400){f <- 0.9}
if (V_ci >= 1401){f <- 1.0}
}
}
f
}
f_p(1, 1232, 323)
#' Traffic Volume Converted to Peak Hour in Roundabout(Vp_i_roundabout)
#'
#' This function calculates traffic volume converted to peak hour(vph) by using PHF(peak hour factor).
#' @param V_i *Numeric* i ramp traffic (vph)
#' @param PHF *Numeric* Peak Hour Factor(PHF). It is a value between 0 and 1.
#' @export Vp_i_roundabout i Traffic volume at the peak of the ramp (vph)
#' @examples
#' Vp(1000, 0.97)
#' Vp(V = 1300, PHF = 0.93)
Vp_i_roundabout <- function(V_i = NULL, PHF = NULL){
V_i / PHF
}
#' Heavy Vehicle Factors in Roundabout(f_hv_roundabout)
#'
#' It follows <Table 11-4> in KHCM(2013) p.500
#' @param lane Choose one from L \code{1}, \code{2}
#' @param hv_ratio Heavy Vehicle Ratio(%)
#' @export f_hv_roundabout Heavy Vehicle Factors in Roundabout
#' @examples
f_hv_roundabout <- function(hv_ratio = NULL){
if (lane == 1){
if (hv_ratio >= 0 & hv_ratio <= 5){fhv <- 2.4}
if (hv_ratio > 5 & hv_ratio <= 10){fhv <- 2.4}
if (hv_ratio > 10 & hv_ratio <= 15){fhv <- 2.4}
if (hv_ratio > 15){fhv <- 2.5}
}
if (lane == 2){
if (hv_ratio >= 0 & hv_ratio <= 5){fhv <- 2.4}
if (hv_ratio > 5 & hv_ratio <= 10){fhv <- 2.5}
if (hv_ratio > 10 & hv_ratio <= 15){fhv <- 2.6}
if (hv_ratio > 15){fhv <- 2.7}
}
fhv
}
#' Conversion factor for passenger cars of heavy vehicles(E_T_roundabout)
#'
#' It follows <Table 11-4> in KHCM(2013) p.500
#' @param lane Choose one from L \code{1}, \code{2}
#' @param hv_ratio Heavy Vehicle Ratio(%)
#' @export f_hv_roundabout Heavy Vehicle Factors in Roundabout
#' @examples
E_T_roundabout <- function(hv_ratio = NULL){
if (lane == 1){
if (hv_ratio >= 0 & hv_ratio <= 5){et <- 2.4}
if (hv_ratio > 5 & hv_ratio <= 10){et <- 2.4}
if (hv_ratio > 10 & hv_ratio <= 15){et <- 2.4}
if (hv_ratio > 15){et <- 2.5}
}
if (lane == 2){
if (hv_ratio >= 0 & hv_ratio <= 5){et <- 2.4}
if (hv_ratio > 5 & hv_ratio <= 10){et <- 2.5}
if (hv_ratio > 10 & hv_ratio <= 15){et <- 2.6}
if (hv_ratio > 15){et <- 2.7}
}
et
}
if (hv_ratio >= 0 & hv_ratio <= 5){et <- 2.4}
#' Conversion factor for passenger cars of heavy vehicles(E_T_roundabout)
#'
#' It follows <Table 11-4> in KHCM(2013) p.500
#' @param lane Choose one from L \code{1}, \code{2}
#' @param hv_ratio Heavy Vehicle Ratio(%)
#' @export E_T_roundabout Conversion factor for passenger cars of heavy vehicles
#' @examples
E_T_roundabout <- function(lane = NULL, hv_ratio = NULL){
if (lane == 1){
if (hv_ratio >= 0 & hv_ratio <= 5){et <- 2.4}
if (hv_ratio > 5 & hv_ratio <= 10){et <- 2.4}
if (hv_ratio > 10 & hv_ratio <= 15){et <- 2.4}
if (hv_ratio > 15){et <- 2.5}
}
if (lane == 2){
if (hv_ratio >= 0 & hv_ratio <= 5){et <- 2.4}
if (hv_ratio > 5 & hv_ratio <= 10){et <- 2.5}
if (hv_ratio > 10 & hv_ratio <= 15){et <- 2.6}
if (hv_ratio > 15){et <- 2.7}
}
et
}
#' Heavy Vehicle Factors in Roundabout(f_hv_roundabout)
#'
#' It follows <Formula 11-4> in KHCM(2013) p.500
#' @param lane Choose one from L \code{1}, \code{2}
#' @param hv_ratio Heavy Vehicle Ratio(%)
#' @param P_T Heavy Vehicle Mixing Ratio
#' @export f_hv_roundabout Heavy Vehicle Factors in Roundabout
#' @examples
f_hv_roundabout <- function(lane = NULL, hv_ratio = NULL, P_T = NULL){
et <- E_T_roundabout(lane = lane, hv_ratio = hv_ratio)
fhv <- 1 / (1 + P_T * (et - 1))
fhv
}
#' i Car traffic per hour on the ramp in roundabout(V_i_pce, pcph)
#'
#' It follows <Formula 11-4> in KHCM(2013) p.500
#' @param V_p_i
#' @param lane
#' @param hv_ratio
#' @param P_T
#' @export V_i_pce
#' @examples
V_i_pce <- function(lane = NULL, hv_ratio = NULL, P_T = NULL){
fhv <- f_hv_roundabout(lane = lane, hv_ratio = hv_ratio, P_T = P_T)
V_p_i / fhv
}
#' i-direction entry traffic in roundabout(V_e_i_roundabout, pcph)
#'
#' It follows <Formula 11-5> in KHCM(2013) p.500
#' @param V_i_L i-direction left turn traffic volume(pcph)
#' @param V_i_T i-direction straight traffic volume(pcph)
#' @param V_i_R i-direction right turn traffic volume(pcph)
#' @param V_i_U i-direction U-turn traffic volume(pcph)
#' @export V_e_i_roundabout
#' @examples
V_e_i_roundabout <- function(V_i_L = NULL, V_i_T = NULL, V_i_R = NULL, V_i_U = NULL){
V_i_L + V_i_T + V_i_R + V_i_U
}
#' i-direction entry traffic in roundabout(V_e_i_roundabout, pcph)
#'
#' It follows <Formula 11-5> in KHCM(2013) p.500
#' @param right_turn_lane Choose one from: \code{'yes'}, \code{'no'}
#' @param V_i_L i-direction left turn traffic volume(pcph)
#' @param V_i_T i-direction straight traffic volume(pcph)
#' @param V_i_R i-direction right turn traffic volume(pcph)
#' @param V_i_U i-direction U-turn traffic volume(pcph)
#' @export V_e_i_roundabout
#' @examples
V_e_i_roundabout <- function(right_turn_lane = NULL, V_i_L = NULL, V_i_T = NULL, V_i_R = NULL, V_i_U = NULL){
if (right_turn_lane == 'no'){v <- V_i_L + V_i_T + V_i_R + V_i_U}
if (right_turn_lane == 'yes'){v <- V_i_L + V_i_T + V_i_U}
v
}
#' Conflict traffic volume on approach i (V_c_i_roundabout, pcph)
#'
#' It follows <Formula 11-5> in KHCM(2013) p.500
#' @param V_ip1 Traffic from Approach i+1 to Approach i+1
#' @param V_ip2 Traffic volume moving from approach i+4 to each approach i+1, i+2
#' @param V_ip3 Traffic volume moving from approach i+4 to each approach i+1, i+2, i+3
#' @param V_ip4 Traffic volume moving from approach i+4 to each approach i+1, i+2, i+3, i+4
#' @export V_c_i_roundabout Conflict traffic volume on approach i (pcph)
#' @examples
V_c_i_roundabout <- function(V_ip1 = NULL, V_ip2 = NULL, V_ip3 = NULL, V_ip4 = NULL){
V_ip1 + V_ip2 + V_ip3 + V_ip4
}
#' Roundabout ramp capacity(c_roundabout, pcph)
#'
#' It follows <Formula 11-2> in KHCM(2013) p.496, <Table 11-8> in p.507
#' @param lane roundabout type. 'rotation lane - entry lane'. Choose one from : \code{'1-1'}, \code{'2-2'}, \code{'2-1'}
#' @param V_c Conflict traffic volume(pcph)
#' @param f_p Crossing Pedestrian Influence Coefficient. See f_p()
#' @export c_roundabout
#' @examples
#' c_roundabout(lane = '1-1', V_c = 382, f_p = 0.8)
c_roundabout <- function(lane = NULL, V_c = NULL, f_p = NULL){
if (lane == '1-1'){
t_c <- 3.21
t_f <- 3.15
t_min <- 2.05
n_e <- 1
}
if (lane == '2-2'){
t_c <- 3.21
t_f <- 3.15
t_min <- 0
n_e <- 1.7
}
if (lane == '2-1'){
t_c <- 3.21
t_f <- 3.15
t_min <- 0
n_e <- 1
}
c <- 3600 * (1-(V_c * t_min / 3600)) * (n_e/t_f) * exp(-1 * (V_c/3600) * (t_c = 0.5 * t_f - t_min)) * f_p
c
}
#' Level of Service(LOS) by average travel speed on arterial roads(LOS_arterial)
#'
#' It follows <Table 12-1> in KHCM(2013) p.529
#' @param free_speed Choose one from: \code{80}, \code{70}, \code{60}
#' @param avg_speed *Numeric* Average travel speed(kph)
#' @keywords
#' @export LOS_arterial Level of Service. \code{A}, \code{B}, \code{C}, \code{D}, \code{E}, \code{F}, \code{FF}, \code{FFF}
#' @examples
LOS_arterial <- function(free_speed = NULL, avg_speed = NULL){
if (free_speed == 80){
if (avg_speed >= 67 & avg_speed <= 85){los <- 'A'}
if (avg_speed >= 51 & avg_speed < 67){los <- 'B'}
if (avg_speed >= 37 & avg_speed < 51){los <- 'C'}
if (avg_speed >= 28 & avg_speed < 37){los <- 'D'}
if (avg_speed >= 21 & avg_speed < 28){los <- 'E'}
if (avg_speed >= 10 & avg_speed < 21){los <- 'F'}
if (avg_speed >= 6 & avg_speed < 10){los <- 'FF'}
if (avg_speed < 6){los <- 'FFF'}
}
if (free_speed == 70){
if (avg_speed >= 60 & avg_speed <= 75){los <- 'A'}
if (avg_speed >= 46 & avg_speed < 60){los <- 'B'}
if (avg_speed >= 33 & avg_speed < 46){los <- 'C'}
if (avg_speed >= 25 & avg_speed < 33){los <- 'D'}
if (avg_speed >= 18 & avg_speed < 25){los <- 'E'}
if (avg_speed >= 10 & avg_speed < 18){los <- 'F'}
if (avg_speed >= 6 & avg_speed < 10){los <- 'FF'}
if (avg_speed < 6){los <- 'FFF'}
}
if (free_speed == 60){
if (avg_speed >= 49 & avg_speed <= 65){los <- 'A'}
if (avg_speed >= 39 & avg_speed < 49){los <- 'B'}
if (avg_speed >= 29 & avg_speed < 39){los <- 'C'}
if (avg_speed >= 20 & avg_speed < 29){los <- 'D'}
if (avg_speed >= 12 & avg_speed < 20){los <- 'E'}
if (avg_speed >= 8 & avg_speed < 12){los <- 'F'}
if (avg_speed >= 5 & avg_speed < 8){los <- 'FF'}
if (avg_speed < 5){los <- 'FFF'}
}
los
}
LOS_arterial(free_speed = 70, avg_speed = 38)
#' Free speed on arterial roads(free_speed_arterial)
#'
#' It follows <Table 12-2> in KHCM(2013) p.533
#' @param road_standard \code{'high'}, \code{'intermediate'}, \code{'low'}
#' @param road_condition \code{'good'}, \code{'normal'}
#' @keywords
#' @export free_speed_arterial
#' @examples
free_speed_arterial <- function(road_standard = NULL, road_condition = NULL){
if (road_standard == 'high'){
if (road_condition == 'good'){fs <- 80}
if (road_condition == 'normal'){fs <- 80}
}
if (road_standard == 'intermediate'){
if (road_condition == 'good'){fs <- 80}
if (road_condition == 'normal'){fs <- 70}
}
if (road_standard == 'low'){
if (road_condition == 'good'){fs <- 70}
if (road_condition == 'normal'){fs <- 60}
}
fs
}
free_speed_arterial('high', 'good')
#' Degree of roadside friction on arterial roads(roadside_friction_arterial)
#'
#' It follows <Table 12-6> in KHCM(2013) p.536
#' @param free_speed Choose one from : \code{80}, \code{70}, \code{60}
#' @param bus_stop Number of bus stop(ea/km)
#' @param entrance_exit Number of entrance and exit(ea/km)
#' @keywords
#' @export roadside_friction_arterial
#' @examples
roadside_friction_arterial <- function(free_speed = NULL, bus_stop = NULL, entrance_exit = NULL){
if (free_speed == 80){
if (bus_stop > 2 | entrance_exit > 2){fr <- 'big'}
if (bus_stop <= 2 | entrance_exit <= 2){fr <- 'small'}
}
if (free_speed == 70){
if (bus_stop > 2 | entrance_exit > 3){fr <- 'big'}
if (bus_stop <= 2 | entrance_exit <= 3){fr <- 'small'}
}
if (free_speed == 60){
if (bus_stop > 2 | entrance_exit > 4){fr <- 'big'}
if (bus_stop <= 2 | entrance_exit <= 4){fr <- 'small'}
}
fr
}
roadside_friction_arterial(2, 3)
#' Degree of roadside friction on arterial roads(roadside_friction_arterial)
#'
#' It follows <Table 12-6> in KHCM(2013) p.536
#' @param free_speed Choose one from : \code{80}, \code{70}, \code{60}
#' @param bus_stop Number of bus stop(ea/km)
#' @param entrance_exit Number of entrance and exit(ea/km)
#' @keywords
#' @export roadside_friction_arterial
#' @examples
roadside_friction_arterial <- function(free_speed = NULL, bus_stop = NULL, entrance_exit = NULL){
if (free_speed == 80){
if (bus_stop > 2 | entrance_exit > 2){fr <- 'big'}
if (bus_stop <= 2 | entrance_exit <= 2){fr <- 'small'}
}
if (free_speed == 70){
if (bus_stop > 2 | entrance_exit > 3){fr <- 'big'}
if (bus_stop <= 2 | entrance_exit <= 3){fr <- 'small'}
}
if (free_speed == 60){
if (bus_stop > 2 | entrance_exit > 4){fr <- 'big'}
if (bus_stop <= 2 | entrance_exit <= 4){fr <- 'small'}
}
fr
}
roadside_friction_arterial(2, 3)
roadside_friction_arterial(80, 2, 3)
